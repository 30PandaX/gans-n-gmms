Starting image batch provider for ../../Datasets/CelebA/img_align_celeba - 23416/5854 (train/test) images.
@Running MFA Teaining. Output folder is ./restuls/celeba_mfa_2c_10l
Initial guess...
init_std [6.98466565e-05 6.79919445e-05 6.99728112e-05 ... 4.65365272e-01
 5.17270204e-01 4.77928027e-01]
type =  <class 'int'>
Collecting an initial sample of 10000 samples...
Performing k-means clustering to 2 components of 10000 samples in dimension 1048/8389 ...
K-means took: 3.0647177696228027 sec
Estimating Factor Analyzer parameters for each cluster
..
Starting Mixture of Factor Analyzers ML SGD Training (10000 iterations)...
[saving model][visualizing].xxxxxxxxxx
Iteration 0: LL = 14979.775390625, Test LL = 15095.2498046875, Mean noise std = 0.13143286108970642
....................................................................................................xxxxxxxxxx
Iteration 100: LL = 15174.033203125, Test LL = 15149.0060546875, Mean noise std = 0.13089828193187714
....................................................................................................xxxxxxxxxx
Iteration 200: LL = 15203.83203125, Test LL = 15198.93857421875, Mean noise std = 0.1299641877412796
....................................................................................................xxxxxxxxxx
Iteration 300: LL = 15209.677734375, Test LL = 15232.21533203125, Mean noise std = 0.12891270220279694
....................................................................................................xxxxxxxxxx
Iteration 400: LL = 15317.228515625, Test LL = 15258.006640625, Mean noise std = 0.1278841495513916
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 500: LL = 15277.228515625, Test LL = 15279.371875, Mean noise std = 0.12680186331272125
....................................................................................................xxxxxxxxxx
Iteration 600: LL = 15334.869140625, Test LL = 15293.63212890625, Mean noise std = 0.12585076689720154
....................................................................................................xxxxxxxxxx
Iteration 700: LL = 15355.80859375, Test LL = 15305.9060546875, Mean noise std = 0.12494228780269623
....................................................................................................xxxxxxxxxx
Iteration 800: LL = 15321.05078125, Test LL = 15318.06552734375, Mean noise std = 0.12403806298971176
....................................................................................................xxxxxxxxxx
Iteration 900: LL = 15319.126953125, Test LL = 15323.97392578125, Mean noise std = 0.12326498329639435
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 1000: LL = 15358.87890625, Test LL = 15331.54541015625, Mean noise std = 0.12254062294960022
....................................................................................................xxxxxxxxxx
Iteration 1100: LL = 15358.337890625, Test LL = 15337.75244140625, Mean noise std = 0.12189734727144241
....................................................................................................xxxxxxxxxx
Iteration 1200: LL = 15380.958984375, Test LL = 15342.97294921875, Mean noise std = 0.12131115049123764
....................................................................................................xxxxxxxxxx
Iteration 1300: LL = 15416.197265625, Test LL = 15346.53681640625, Mean noise std = 0.12075160443782806
....................................................................................................xxxxxxxxxx
Iteration 1400: LL = 15294.568359375, Test LL = 15350.1994140625, Mean noise std = 0.12026797235012054
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 1500: LL = 15353.759765625, Test LL = 15353.844140625, Mean noise std = 0.11981983482837677
....................................................................................................xxxxxxxxxx
Iteration 1600: LL = 15380.734375, Test LL = 15357.4486328125, Mean noise std = 0.11942843347787857
....................................................................................................xxxxxxxxxx
Iteration 1700: LL = 15355.4365234375, Test LL = 15358.18955078125, Mean noise std = 0.11910923570394516
....................................................................................................xxxxxxxxxx
Iteration 1800: LL = 15346.5986328125, Test LL = 15360.39248046875, Mean noise std = 0.11877890676259995
....................................................................................................xxxxxxxxxx
Iteration 1900: LL = 15380.0478515625, Test LL = 15361.2857421875, Mean noise std = 0.11847046762704849
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 2000: LL = 15344.490234375, Test LL = 15363.9111328125, Mean noise std = 0.11818698793649673
....................................................................................................xxxxxxxxxx
Iteration 2100: LL = 15372.203125, Test LL = 15365.794921875, Mean noise std = 0.11796342581510544
....................................................................................................xxxxxxxxxx
Iteration 2200: LL = 15422.9775390625, Test LL = 15366.3841796875, Mean noise std = 0.11781958490610123
....................................................................................................xxxxxxxxxx
Iteration 2300: LL = 15293.037109375, Test LL = 15367.870703125, Mean noise std = 0.1176387295126915
....................................................................................................xxxxxxxxxx
Iteration 2400: LL = 15265.353515625, Test LL = 15369.21689453125, Mean noise std = 0.11742974817752838
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 2500: LL = 15370.392578125, Test LL = 15369.5076171875, Mean noise std = 0.1172691062092781
....................................................................................................xxxxxxxxxx
Iteration 2600: LL = 15282.69921875, Test LL = 15371.28486328125, Mean noise std = 0.11712264269590378
....................................................................................................xxxxxxxxxx
Iteration 2700: LL = 15316.978515625, Test LL = 15372.32880859375, Mean noise std = 0.11697939783334732
....................................................................................................xxxxxxxxxx
Iteration 2800: LL = 15394.568359375, Test LL = 15373.4205078125, Mean noise std = 0.11686574667692184
....................................................................................................xxxxxxxxxx
Iteration 2900: LL = 15394.421875, Test LL = 15373.1400390625, Mean noise std = 0.11673760414123535
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 3000: LL = 15409.669921875, Test LL = 15375.04619140625, Mean noise std = 0.11662092059850693
....................................................................................................xxxxxxxxxx
Iteration 3100: LL = 15351.755859375, Test LL = 15375.79189453125, Mean noise std = 0.1165495440363884
....................................................................................................xxxxxxxxxx
Iteration 3200: LL = 15387.5703125, Test LL = 15377.02138671875, Mean noise std = 0.11649268865585327
....................................................................................................xxxxxxxxxx
Iteration 3300: LL = 15443.080078125, Test LL = 15377.672265625, Mean noise std = 0.11640974134206772
....................................................................................................xxxxxxxxxx
Iteration 3400: LL = 15324.158203125, Test LL = 15378.419921875, Mean noise std = 0.11628542840480804
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 3500: LL = 15374.400390625, Test LL = 15378.5169921875, Mean noise std = 0.1162000522017479
....................................................................................................xxxxxxxxxx
Iteration 3600: LL = 15331.25390625, Test LL = 15378.705859375, Mean noise std = 0.11610213667154312
....................................................................................................xxxxxxxxxx
Iteration 3700: LL = 15374.783203125, Test LL = 15379.82314453125, Mean noise std = 0.11602674424648285
....................................................................................................xxxxxxxxxx
Iteration 3800: LL = 15385.2900390625, Test LL = 15380.5783203125, Mean noise std = 0.11600068211555481
....................................................................................................xxxxxxxxxx
Iteration 3900: LL = 15288.111328125, Test LL = 15380.6806640625, Mean noise std = 0.11591275781393051
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 4000: LL = 15366.837890625, Test LL = 15380.9265625, Mean noise std = 0.11587914079427719
....................................................................................................xxxxxxxxxx
Iteration 4100: LL = 15372.3779296875, Test LL = 15380.77158203125, Mean noise std = 0.11584106832742691
....................................................................................................xxxxxxxxxx
Iteration 4200: LL = 15383.8515625, Test LL = 15381.44228515625, Mean noise std = 0.1157601922750473
....................................................................................................xxxxxxxxxx
Iteration 4300: LL = 15408.1220703125, Test LL = 15381.4685546875, Mean noise std = 0.11567726731300354
....................................................................................................xxxxxxxxxx
Iteration 4400: LL = 15307.7255859375, Test LL = 15382.5056640625, Mean noise std = 0.11568649113178253
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 4500: LL = 15361.2578125, Test LL = 15382.75966796875, Mean noise std = 0.11565053462982178
....................................................................................................xxxxxxxxxx
Iteration 4600: LL = 15362.78515625, Test LL = 15383.551953125, Mean noise std = 0.1155930608510971
....................................................................................................xxxxxxxxxx
Iteration 4700: LL = 15458.7626953125, Test LL = 15383.70009765625, Mean noise std = 0.11554790288209915
....................................................................................................xxxxxxxxxx
Iteration 4800: LL = 15358.064453125, Test LL = 15384.23955078125, Mean noise std = 0.11548478901386261
....................................................................................................xxxxxxxxxx
Iteration 4900: LL = 15340.61328125, Test LL = 15384.18994140625, Mean noise std = 0.11543839424848557
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 5000: LL = 15348.2734375, Test LL = 15384.9728515625, Mean noise std = 0.11545270681381226
....................................................................................................xxxxxxxxxx
Iteration 5100: LL = 15431.6015625, Test LL = 15384.65810546875, Mean noise std = 0.11545495688915253
....................................................................................................xxxxxxxxxx
Iteration 5200: LL = 15364.486328125, Test LL = 15384.54345703125, Mean noise std = 0.11547069996595383
....................................................................................................xxxxxxxxxx
Iteration 5300: LL = 15403.583984375, Test LL = 15385.59228515625, Mean noise std = 0.11549804359674454
....................................................................................................xxxxxxxxxx
Iteration 5400: LL = 15407.109375, Test LL = 15385.30283203125, Mean noise std = 0.1155097559094429
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 5500: LL = 15381.0419921875, Test LL = 15385.8123046875, Mean noise std = 0.11550664156675339
....................................................................................................xxxxxxxxxx
Iteration 5600: LL = 15385.6259765625, Test LL = 15385.71806640625, Mean noise std = 0.11553027480840683
....................................................................................................xxxxxxxxxx
Iteration 5700: LL = 15410.3359375, Test LL = 15385.6474609375, Mean noise std = 0.11553731560707092
....................................................................................................xxxxxxxxxx
Iteration 5800: LL = 15397.6748046875, Test LL = 15386.2216796875, Mean noise std = 0.11553288996219635
....................................................................................................xxxxxxxxxx
Iteration 5900: LL = 15432.1328125, Test LL = 15385.19052734375, Mean noise std = 0.11553222686052322
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 6000: LL = 15349.5498046875, Test LL = 15386.4216796875, Mean noise std = 0.11549653857946396
....................................................................................................xxxxxxxxxx
Iteration 6100: LL = 15362.8955078125, Test LL = 15386.369921875, Mean noise std = 0.11548241972923279
....................................................................................................xxxxxxxxxx
Iteration 6200: LL = 15417.046875, Test LL = 15385.95546875, Mean noise std = 0.11545047909021378
....................................................................................................xxxxxxxxxx
Iteration 6300: LL = 15415.97265625, Test LL = 15386.74453125, Mean noise std = 0.11543675512075424
....................................................................................................xxxxxxxxxx
Iteration 6400: LL = 15318.462890625, Test LL = 15386.47626953125, Mean noise std = 0.1154431477189064
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 6500: LL = 15328.2509765625, Test LL = 15387.21552734375, Mean noise std = 0.11547068506479263
....................................................................................................xxxxxxxxxx
Iteration 6600: LL = 15402.880859375, Test LL = 15386.7021484375, Mean noise std = 0.11545809358358383
....................................................................................................xxxxxxxxxx
Iteration 6700: LL = 15396.53515625, Test LL = 15387.2201171875, Mean noise std = 0.11542391777038574
....................................................................................................xxxxxxxxxx
Iteration 6800: LL = 15407.44140625, Test LL = 15386.7513671875, Mean noise std = 0.11541994661092758
....................................................................................................xxxxxxxxxx
Iteration 6900: LL = 15386.521484375, Test LL = 15386.496484375, Mean noise std = 0.11539590358734131
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 7000: LL = 15350.3203125, Test LL = 15387.42099609375, Mean noise std = 0.11538860946893692
....................................................................................................xxxxxxxxxx
Iteration 7100: LL = 15366.130859375, Test LL = 15387.43173828125, Mean noise std = 0.11536841839551926
....................................................................................................xxxxxxxxxx
Iteration 7200: LL = 15350.599609375, Test LL = 15387.90068359375, Mean noise std = 0.1153373047709465
....................................................................................................xxxxxxxxxx
Iteration 7300: LL = 15408.28125, Test LL = 15387.09111328125, Mean noise std = 0.11536125093698502
....................................................................................................xxxxxxxxxx
Iteration 7400: LL = 15327.1962890625, Test LL = 15387.332421875, Mean noise std = 0.11534150689840317
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 7500: LL = 15465.40234375, Test LL = 15387.30380859375, Mean noise std = 0.1153281107544899
....................................................................................................xxxxxxxxxx
Iteration 7600: LL = 15326.865234375, Test LL = 15387.99072265625, Mean noise std = 0.11531607061624527
....................................................................................................xxxxxxxxxx
Iteration 7700: LL = 15385.125, Test LL = 15387.586328125, Mean noise std = 0.11532866209745407
....................................................................................................xxxxxxxxxx
Iteration 7800: LL = 15441.3037109375, Test LL = 15388.09462890625, Mean noise std = 0.11533834785223007
....................................................................................................xxxxxxxxxx
Iteration 7900: LL = 15442.4453125, Test LL = 15387.65947265625, Mean noise std = 0.11531525105237961
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 8000: LL = 15404.912109375, Test LL = 15387.39765625, Mean noise std = 0.11535966396331787
....................................................................................................xxxxxxxxxx
Iteration 8100: LL = 15401.265625, Test LL = 15388.55556640625, Mean noise std = 0.11539505422115326
....................................................................................................xxxxxxxxxx
Iteration 8200: LL = 15349.7265625, Test LL = 15388.9376953125, Mean noise std = 0.11536901444196701
....................................................................................................xxxxxxxxxx
Iteration 8300: LL = 15402.671875, Test LL = 15388.82861328125, Mean noise std = 0.11536836624145508
....................................................................................................xxxxxxxxxx
Iteration 8400: LL = 15337.3681640625, Test LL = 15388.5056640625, Mean noise std = 0.11542441695928574
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 8500: LL = 15444.37890625, Test LL = 15388.66875, Mean noise std = 0.11537577211856842
....................................................................................................xxxxxxxxxx
Iteration 8600: LL = 15409.484375, Test LL = 15388.17041015625, Mean noise std = 0.1153448224067688
....................................................................................................xxxxxxxxxx
Iteration 8700: LL = 15317.9189453125, Test LL = 15388.4544921875, Mean noise std = 0.1153058260679245
....................................................................................................xxxxxxxxxx
Iteration 8800: LL = 15366.126953125, Test LL = 15387.8701171875, Mean noise std = 0.11537312716245651
....................................................................................................xxxxxxxxxx
Iteration 8900: LL = 15392.8173828125, Test LL = 15388.17685546875, Mean noise std = 0.11535554379224777
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 9000: LL = 15385.720703125, Test LL = 15388.32841796875, Mean noise std = 0.11538942903280258
....................................................................................................xxxxxxxxxx
Iteration 9100: LL = 15402.12890625, Test LL = 15388.45947265625, Mean noise std = 0.11537506431341171
....................................................................................................xxxxxxxxxx
Iteration 9200: LL = 15367.74609375, Test LL = 15388.29541015625, Mean noise std = 0.11532450467348099
....................................................................................................xxxxxxxxxx
Iteration 9300: LL = 15445.490234375, Test LL = 15388.93505859375, Mean noise std = 0.11533722281455994
....................................................................................................xxxxxxxxxx
Iteration 9400: LL = 15320.611328125, Test LL = 15388.4421875, Mean noise std = 0.11536887288093567
...................................................................................................[saving model][visualizing].xxxxxxxxxx
Iteration 9500: LL = 15278.09375, Test LL = 15388.84091796875, Mean noise std = 0.11540214717388153
....................................................................................................xxxxxxxxxx
Iteration 9600: LL = 15375.431640625, Test LL = 15386.6255859375, Mean noise std = 0.11538607627153397
....................................................................................................xxxxxxxxxx
Iteration 9700: LL = 15412.291015625, Test LL = 15388.40849609375, Mean noise std = 0.11534889787435532
....................................................................................................xxxxxxxxxx
Iteration 9800: LL = 15366.080078125, Test LL = 15388.56865234375, Mean noise std = 0.11531368643045425
....................................................................................................xxxxxxxxxx
Iteration 9900: LL = 15438.9453125, Test LL = 15388.17021484375, Mean noise std = 0.11533435434103012
..................................................................................................[saving model][visualizing].MFA Training ended.
Done
